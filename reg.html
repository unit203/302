<!DOCTYPE html>
<html lang="ru">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <!-- <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
      integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn"
      crossorigin="anonymous"
    /> -->
    <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="css/lesson-4-08.css" />
    <title>Форма регистрации</title>

    <!-- <link rel="stylesheet" href="css/style.css" /> -->
  </head>
  <body>
    <header class="header"></header>
    <main class="main">
      <h1 class="text-center mt-5">Форма регистрации</h1>
      <p id="info" style="color:#d92134"></p>
      <div class="col-5 mx-auto">
        <!-- <form action="php/reg_obr.php" method="POST"> -->
        <form onsubmit="sendForm(this); return false;">
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <div class="input-group-text"><span class="material-icons">person</span></div>
              <!-- <span class="material-icons">person</span> -->
            </div>
            <input
              type="text"
              class="form-control"
              placeholder="Имя"
              required
              autocomplete="username"
              onfocus="this.placeholder=''"
              onblur="this.placeholder='Имя'"
              minlength="3"
              name="name"
            />
          </div>

          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <div class="input-group-text"><span class="material-icons">person</span></div>
            </div>
            <input
              type="text"
              class="form-control"
              placeholder="Фамилия"
              required
              autocomplete="username"
              onfocus="this.placeholder=''"
              onblur="this.placeholder='Фамилия'"
              minlength="3"
              name="lastname"
            />
          </div>
          <!-- <p id="info" style="color:#d92134"></p> -->
          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <div class="input-group-text"><span class="material-icons">mail</span></div>
            </div>
            <input
              type="text"
              class="form-control"
              placeholder="Email"
              required
              autocomplete="mail"
              onfocus="this.placeholder=''"
              onblur="this.placeholder='Email'"
              minlength="3"
              name="email"
            />
          </div>

          <div class="input-group mb-3">
            <div class="input-group-prepend">
              <div class="input-group-text"><span class="material-icons">password</span></div>
            </div>
            <input
              type="password"
              class="form-control"
              placeholder="Password"
              required
              autocomplete="username"
              onfocus="this.placeholder=''"
              onblur="this.placeholder='Password'"
              minlength="3"
              id="formPass"
              name="pass"
            />
          </div>

          <div class="form-check mb-3">
            <input class="form-check-input" type="checkbox" id="autoSizingCheck" />
            <label class="form-check-label" for="autoSizingCheck"> Согласие на обработку персональных данных </label>
          </div>
          <input type="submit" class="btn btn-warning" value="Зарегистрироваться">




          
        </form>





      </div>
    </main>
    <footer class="footer"></footer>

    <script>
			// async function sendForm(form) {
			// 	let response = await fetch("php/reg_obr.php", {
			// 		method: "POST",
			// 		body: new FormData(form)
			// 	});
      //   console.log(await response.text());
			// 	let result = await response.text();
      //   console.log(result);




			// 	if (result == "ok") {
			// 		alert("Успех!");
			// 	} else {
			// 		info.innerText = "Такой пользователь существует";
			// 	}
			// }

      async function sendForm(form) {
        // alert("1");
				let response = await fetch("php/reg_obr.php", {
					method: "POST",
					body: new FormData(form)
				});

				let result = await response.text();
        console.log(typeof result);
        console.log(result);
        let resultString = String(result);

        console.log(resultString);
        console.log(typeof resultString);
        
        let answer = 'true';
        console.log(answer);
        console.log(typeof answer);

				if (resultString == answer) {
					alert("Успех!");
				} else {
          console.log('сработал ЕЛС');
					info.innerText = "Такой пользователь существует";
				}
			}
    </script>







    <script
      src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
